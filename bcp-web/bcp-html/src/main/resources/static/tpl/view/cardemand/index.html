<div class="hbox hbox-auto-xs bg-light ">
    <div class="col lter b-l">
        <div class="vbox">
            <div class="wrapper b-b b-light">
                <div class="font-thin h4">{{title}}</div>
            </div>

            <div class="row-row">
                <div class="cell" style="overflow-x: hidden;overflow-y: auto">
                    <div class="cell-inner">
                        <div class="row padder-v m-n lt">
                            <div class="col-sm-4 m-b-xs ">
                                <select class="form-control" ng-model="searchFilter.statusValue" ng-change="search()">
                                    <option value="-1">全部</option>
                                    <option value="100">待处理</option>
                                    <option value="0">待审核</option>
                                    <option value="1">审核中</option>
                                    <option value="2">审核通过</option>
                                    <option value="8">驳回待提交</option>
                                    <option value="9">拒绝</option>
                                </select>
                            </div>
                            <div class="col-sm-1 text-left">
                                <select class="form-control" ng-model="pageSize" ng-change="changePageSize()">
                                    <option value="10">10</option>
                                    <option value="20">20</option>
                                    <option value="50">50</option>
                                    <option value="100">100</option>
                                    <option value="1000">1000</option>
                                </select>
                            </div>
                            <div class="col-sm-6 m-b-xs text-right">
                                <a role="button" class="btn btn-sm btn-primary"  ng-click="showQuery()">查询</a>
                            </div>
                            <div class="col-sm-1 m-b-xs text-right"></div>
                        </div>
                        <div class="row">
                            <div class="col-lg-3">
                                <table class="table table-striped">
                                    <thead>
                                        <tr>
                                            <th>
                                                序号
                                            </th>
                                            <th>
                                                报单支行
                                            </th>
                                            <th>
                                                客户姓名【身份证号码】
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr style="height:40px" ng-repeat="cardemand in cardemands " ng-class="{2: 'success', 8: 'warning', 9: 'danger'}[cardemand.approveStatus]">
                                            <td>{{$index+1}}</td>
                                            <td><cashsource-info ng-if="cardemand.cashSourceId !== undefined" id="cardemand.cashSourceId"></cashsource-info></td>
                                            <td><customer-info ng-if="cardemand.customerId !== undefined" id="cardemand.customerId"></customer-info></td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                            <td></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="col-lg-7" style="margin-left:-40px;overflow: scroll;overflow-y: hidden;">
                                <table class="table table-striped" data-filter="#filter">
                                    <thead>
                                        <tr>
                                            <th>
                                                渠道支行
                                            </th>
                                            <th>
                                                业务类型
                                            </th>
                                            <th>
                                                分期经理【手机号码】
                                            </th>
                                            <th class="text-right">
                                                贷款金额【期限-类型】
                                            </th>
                                            <th class="text-right">
                                                银行手续费(元)【缴纳方式】
                                            </th>
                                            <th>
                                                审核状态
                                            </th>
                                            <th>
                                                当前任务
                                            </th>
                                            <th>
                                                提交时间
                                            </th>
                                            <th>
                                                业务处理时间
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr style="height:40px" ng-repeat="cardemand in cardemands " ng-class="{2: 'success', 8: 'warning', 9: 'danger'}[cardemand.approveStatus]">
                                            <td><cardealer-cooperationcashsource-info ng-if="cardemand.carDealerId !== undefined" id="cardemand.carDealerId"></cardealer-cooperationcashsource-info></td>
                                            <td>{{cardemand.businessTypeCode | BusinessTypeFilter}}</td>
                                            <td><employee-info ng-if="cardemand.employeeId !== undefined" id="cardemand.employeeId"></employee-info></td>
                                            <td class="text-right"><payment-demandamount id="cardemand.customerLoanId"></payment-demandamount></td>
                                            <td class="text-right"><bankfee-info id="cardemand.customerLoanId"></bankfee-info></td>
                                            <td><approve-status ng-if="cardemand.approveStatus != null && cardemand.transaction != null" transaction="cardemand.transaction" status="cardemand.approveStatus" billtypecode="cardemand.billTypeCode"></approve-status></td>
                                            <td><flow-getpresenttaskgroup billtypecode="cardemand.billTypeCode" billid="cardemand.id" ng-if="cardemand.transaction !== undefined" transaction="cardemand.transaction"></flow-getpresenttaskgroup></td>
                                            <td>{{cardemand.ts | momentDate: 'YYYY-MM-DD HH:mm:ss'}}</td>
                                            <td>{{cardemand.approveDate | momentDate: 'YYYY-MM-DD HH:mm:ss'}}</td>
                                        </tr>
                                        <tr>
                                            <td></td>
                                            <td></td>
                                            <td class="text-center">本页合计：</td>
                                            <td class="text-left">{{totalCreditAmount | currency:"￥"}}</td>
                                            <td class="text-right">{{totalBankFeeAmount | currency:"￥"}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="col-lg-1" style="margin-left:-25px;">
                                <table class="table table-striped" data-filter="#filter">
                                    <thead>
                                        <tr class="bg-white">
                                            <th>
                                                我的任务
                                            </th>
                                            <th>
                                                操作
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr style="height:40px" class="bg-white" ng-repeat="cardemand in cardemands " ng-class="{2: 'success', 8: 'warning', 9: 'danger'}[cardemand.approveStatus]">
                                            <td><flow-info ng-if="cardemand.id !== undefined"  billtypecode="cardemand.billTypeCode" billid="cardemand.id"></flow-info></td>
                                            <td>
                                                <div class="btn-group dropdown" dropdown>
                                                    <button class="btn btn-success btn-xs" dropdown-toggle>操作<span class="caret"></span></button>
                                                    <ul class="dropdown-menu">
                                                        <li><a class="blue" ng-click="edit(cardemand, $index)" ng-show="true" href>浏览</a></li>
                                                        <li><a class="blue" ng-click="goDeclaration(cardemand, $index)" ng-show="true" href>银行报批</a></li>
                                                    </ul>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row b-t b-light m-n lt">
                <div class="col-sm-2 text-left">
                    <ul class="pagination ng-isolate-scope ng-valid">当前页：{{currentPage}}，总计{{totalPages}}页</ul>
                </div>
                <div class="col-sm-9 text-right">
                    <pagination max-size="10" more="true" total-items="totalItems" boundary-links="true" first-text="首页" last-text="尾页"   ng-change="changePage()"  ng-model="currentPage" items-per-page="pageSize" total-items="totalItems"  previous-text="上一页" next-text="下一页"></pagination>
                </div>
                <div class="col-sm-1 text-right"></div>
            </div>
        </div>
    </div>
</div>

<pageslide ps-open="checked" ps-zindex="1035" ps-size="1500px" ps-body-class="true" ps-auto-close="false" ps-click-outside="false" onopen="onOpenSidePanel" onclose="onCloseSidePanel">

    <div class="hbox hbox-auto-xs bg-light ">
        <div class="col lter b-l">
            <div class="vbox">
                <div class="wrapper-sm b-t b-light">
                    <div class="panel-body">
                        <div class="col-sm-5 text-left  text-info">
                            <h1 class="m-n font-thin h3">{{title}}--{{cardemand.businessTypeCode |BusinessTypeFilter}}
                                <span ng-class="{1:'text-info',2: 'text-success', 8: 'text-warning', 9: 'text-danger'}[cardemand.approveStatus]">({{cardemand.approveStatus | approveStatusFilter}})</span>
                                <span ng-class="{11:'text-danger',16: 'text-primary'}[cardemand.transaction.status]" ng-if="cardemand.transaction" ng-show="cardemand.transaction.status == 11 || cardemand.transaction.status == 16">---{{cardemand.transaction.status | StatusFilter}}</span>
                            </h1>
                        </div>
                        <div class="col-sm-5 text-left">
                            <label class="col-sm-4 control-label"><h4>是否为自雇人士: </h4></label>
                            <div class="col-sm-5">
                                <ui-select ng-model="cardemand.customer.isSelfEmployed" name="isSelfEmployed" theme="bootstrap" ng-disabled="presentTask != '征信查询'" on-select="changeCustomerType(cardemand.customer,$item)">
                                    <ui-select-match  placeholder="请选择是否为自雇人士" >{{$select.selected.name}}</ui-select-match>
                                    <ui-select-choices repeat="customertype.code as customertype in customertypes | filter: $select.search">
                                        <div ng-bind-html="customertype.name"></div>
                                    </ui-select-choices>
                                </ui-select>
                            </div>
                        </div>
                        <div class="col-sm-2 text-right">
                        </div>
                    </div>
                </div>

                <div class="row-row">
                    <div class="cell">
                        <div class="cell-inner">
                            <div class="padder-v row m-n">
                                <div class="col-lg-9">
                                    <div class="panel panel-default">
                                        <div class="panel-heading">
                                            <span class="h4">来源渠道</span>
                                        </div>
                                        <div class="panel-body">
                                            <cardealer-block ng-if="cardemand.carDealerId != undefined" id="cardemand.carDealerId"></cardealer-block>
                                        </div>
                                    </div>

                                    <div class="panel panel-primary">
                                        <div class="panel-heading">
                                            <button class="btn btn-primary btn-xs pull-right" ng-show="cardemand.creditMasterId" type="button" ng-click="customercredit(cardemand.creditMasterId)">征信拍照</button>
                                            <span class="h4">贷款人信息</span>
                                        </div>
                                        <div class="panel-body">
                                            <customer-block id="cardemand.creditMasterId"></customer-block>
                                        </div>
                                    </div>

                                    <div class="panel panel-default" ng-show="cardemand.mateCustomerId != null">
                                        <div class="panel-heading">
                                            <button class="btn btn-primary btn-xs pull-right" type="button" ng-click="customercredit(cardemand.mateCustomerId)">征信拍照</button>
                                            <span class="h4">配偶身份证信息</span>
                                        </div>
                                        <div class="panel-body">
                                            <customer-relation-block id="cardemand.mateCustomerId" proname="1"></customer-relation-block>
                                        </div>
                                    </div>

                                    <div class="panel panel-default">
                                        <div class="panel-heading">
                                            <button class="btn btn-primary btn-xs pull-right" type="button" ng-click="customercredit(cardemand.pledgeCustomerId)">征信拍照</button>
                                            <span class="h4">指标人信息</span>
                                        </div>
                                        <div class="panel-body">
                                            <div ng-show="cardemand.relation != '0' ">
                                                <customer-relation-block ng-if="cardemand.pledgeCustomerId != undefined" id="cardemand.pledgeCustomerId" proname="2"></customer-relation-block>
                                            </div>
                                            <div class="form-group pull-in clearfix">
                                                <div class="col-lg-12">
                                                    <label>与贷款人关系</label>
                                                    <p  ng-class="{1:'text-danger',2: 'text-danger', 3: 'text-danger'}[cardemand.relation]" class="form-control-static b-b">{{cardemand.relation |relationFilter}}</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="panel panel-default">
                                        <div class="panel-heading"><span class="h4">拟购车辆信息</span></div>
                                        <div class="panel-body">
                                            <customer-car ng-if="cardemand.customerCarId !== undefined" id="cardemand.customerCarId" billtypecode="cardemand.billTypeCode" businesstypecode="cardemand.businessTypeCode"></customer-car>
                                        </div>
                                    </div>

                                    <div class="panel panel-primary">
                                        <div class="panel-heading">
                                            <span class="h4">贷款信息</span>
                                        </div>
                                        <div class="panel-body">
                                            <div class="row">
                                                <div class="col-lg-12">
                                                    <div class="form-group pull-in clearfix">
                                                        <div class="col-sm-3">
                                                            <label>分期申请车价(元)</label>
                                                            <p class="form-control-static b-b">{{cardemand.customerLoan.applyAmount || 0 |currency:'￥'}}</p>
                                                        </div>
                                                        <div class="col-sm-3">
                                                            <label>官方指导价(元)</label>
                                                            <p class="form-control-static b-b">{{cardemand.customerCar.guidePrice || 0 |currency:'￥'}}</p>
                                                        </div>
                                                        <div class="col-sm-3">
                                                            <label>车辆开票价（元）</label>
                                                            <p class="form-control-static b-b">{{cardemand.customerLoan.receiptPrice || 0 |currency:'￥'}}</p>
                                                        </div>
                                                        <div class="col-sm-3">
                                                            <label>预计成交价(元)</label>
                                                            <p class="form-control-static b-b">{{cardemand.customerLoan.realPrice || 0 |currency:'￥'}}</p>
                                                        </div>
                                                        <div class="col-sm-3" ng-show="cardemand.businessTypeCode == 'OC' ">
                                                            <label>预计评估价（元）</label>
                                                            <p class="form-control-static b-b">{{cardemand.customerCar.evaluatePrice || 0 |currency:'￥'}}</p>
                                                        </div>
                                                        <div class="col-sm-3">
                                                            <label>贷款金额(元)</label>
                                                            <p class="form-control-static b-b text-danger">{{cardemand.customerLoan.creditAmount || 0 |currency:'￥'}}</p>
                                                        </div>
                                                        <div class="col-sm-3">
                                                            <label>贷款比例(%)</label>
                                                            <p class="form-control-static b-b text-danger">{{cardemand.customerLoan.creditRatio || 0 }}%</p>
                                                        </div>
                                                        <div class="col-sm-3">
                                                            <label>首付金额(元)</label>
                                                            <p class="form-control-static b-b">{{cardemand.customerLoan.downPayment || 0 |currency:'￥'}}</p>
                                                        </div>
                                                        <div class="col-sm-3">
                                                            <label>首付比例(%)</label>
                                                            <p class="form-control-static b-b">{{cardemand.customerLoan.downPaymentRatio || 0 }}%</p>
                                                        </div>
                                                        <div class="col-sm-3">
                                                            <label>贷款期数(期)</label>
                                                            <p class="form-control-static b-b">{{cardemand.customerLoan.rateType.months || 0 }}期</p>
                                                        </div>
                                                        <div class="col-sm-3">
                                                            <label>银行手续费率(%)</label>
                                                            <p class="form-control-static b-b text-danger">{{cardemand.customerLoan.rateType.ratio || 0 | percentage:2:"%" }}</p>
                                                        </div>
                                                        <div class="col-sm-3">
                                                            <label>银行手续费(元)</label>
                                                            <p class="form-control-static b-b">{{cardemand.customerLoan.bankFeeAmount || 0 |currency:'￥' }}</p>
                                                        </div>
                                                        <div class="col-sm-3">
                                                            <label>手续费缴纳方式</label>
                                                            <p class="form-control-static b-b text-danger">{{cardemand.customerLoan.chargePaymentWay |chargePaymentWayFilter }}</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="panel panel-default">
                                        <div class="panel-heading"><span class="h4">档案资料</span></div>
                                        <div class="panel-body">
                                            <customerimage-block ng-if="cardemand !== null" canAudit="true" bill="cardemand"></customerimage-block>
                                        </div>
                                    </div>

                                    <div class="panel panel-default" ng-if="cardemand.billType.documentIds.length > 0">
                                        <div class="panel-heading">
                                            <span class="h4">文档信息</span>
                                        </div>
                                        <business-contract-block ng-if="cardemand !== null" bill="cardemand"></business-contract-block>
                                    </div>
                                </div>

                                <div class="col-lg-3">
                                    <div style="position: fixed;" ng-show="checked">
                                        <div style="height:650px;overflow-y:scroll;">
                                            <!--当前业务分期经理 -->
                                            <div class="panel b-success b-light clearfix">
                                                <div class="panel-body">
                                                    <a href="" class="thumb avatar pull-left m-r">
                                                        <employee-avatar ng-if="cardemand.employeeId !== undefined" id="cardemand.employeeId"></employee-avatar>
                                                        <i class="on b-white bottom"></i>
                                                    </a>
                                                    <div class="clear">
                                                        <employee-info ng-if="cardemand.employeeId !== undefined" id="cardemand.employeeId"></employee-info>
                                                        <br/><br/>
                                                        <small class="block text-muted text-xs"><i class="icon-action-redo"></i>当前业务分期经理</small>
                                                    </div>
                                                </div>
                                            </div>
                                            <!--显示订单的签批信息-->
                                            <div class="m-b-md clearfix" ng-show="cardemand.id != null">
                                                <tem-signinfo-list ng-if="cardemand.id !== undefined" id="cardemand.id" billtypecode="cardemand.billTypeCode"></tem-signinfo-list>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="wrapper-sm b-t b-light text-right">
                    <div class="panel-body">
                        <div class="col-sm-6 text-left">
                            <button class="btn btn-success" type="button" ng-click="customercheck(cardemand)">客户核对</button>
                            <!-- //TODO  根据登录人的权限和审批流的状态判断是否显示该按钮-->
                            <button class="btn btn-info" type="button" ng-click="createCustomerSurvey()">分配调查模版</button>
                        </div>
                        <div class="col-sm-6 text-right">
                            <!--<sign-button ng-if="cardemand.id && cardemand.transaction" billid="cardemand.id" billtypecode="cardemand.billTypeCode" transaction="cardemand.transaction"></sign-button>-->
                            <tem-sign-button ng-if="cardemand.id && cardemand.transaction" billid="cardemand.id" billtypecode="cardemand.billTypeCode" transaction="cardemand.transaction" customer="cardemand.customer" customerloan="cardemand.customerLoan"></tem-sign-button>
                            <button class="btn btn-primary" type="button" ng-click="close()">关 闭</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</pageslide>
<!------查询输入框-->
<script type="text/ng-template" id="query.html">
    <query-form search="searchFilter" query="queryBill(search)" clear="clearQuery()"></query-form>
</script>
<!------签批对话框------>
<script type="text/ng-template" id="audit.html">
    <signinfo-block sign="sign(signinfo)"></signinfo-block>
</script>
<!------客户的征信拍照------->
<script type="text/ng-template" id="creditForm.html">
    <creditphotographimage-block ng-if="cutomerid !== null" id="cutomerid"></creditphotographimage-block>
</script>