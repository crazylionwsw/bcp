<div class="hbox hbox-auto-xs bg-light ">
    <div class="col lter b-l">
        <div class="vbox">
            <div class="wrapper b-b b-light">
                <div class="font-thin h4">{{title}}</div>
            </div>
            <div class="row-row">
                <div class="cell">
                    <div class="cell-inner">
                        <div class="row padder-v m-n lt">
                            <div class="col-sm-12 m-b-xs ">
                                <div class="col-sm-12 m-b-xs text-right ">
                                    <a role="button" class="btn btn-sm btn-primary"  ng-click="account()">计 算</a>
                                </div>
                            </div>
                            <!--<div class="col-sm-8 m-b-xs text-right ">
                                <a role="button" class="btn btn-sm btn-primary"  ng-click="showQuery()">查询</a>
                            </div>-->
                        </div>
                        <div class="">
                            <table class="table table-striped b-t b-light" >
                                <thead>
                                <tr>
                                    <th class="text-center">
                                        序号
                                    </th>
                                    <th class="text-center">
                                        年-月
                                    </th>
                                    <th class="text-right">
                                        放款合计
                                    </th>
                                    <th class="text-right">
                                        结算费用合计
                                    </th>
                                    <th class="text-center">
                                        业务状态
                                    </td>
                                    <th class="text-center">
                                        计算人
                                    </th>
                                    <th class="text-center">
                                        核对人</th>
                                    <th class="text-center">
                                        核对日期</th>
                                    <th class="text-center">
                                        结算人</th>
                                    <th class="text-center">
                                        操作
                                    </th>
                                </tr>
                                </thead>
                                <tbody ng-repeat="balanceaccount in balanceaccounts | filter:query | orderBy: 'balanceaccount.month': true" ng-class="{9: 'success', 1: 'warning', 2: 'danger'}[balanceaccount.checkStatus]">
                                <tr>
                                    <td class="text-center">{{$index+1}}</td>
                                    <td class="text-center">{{balanceaccount.year}}-{{balanceaccount.month}}</td>
                                    <td class="text-right">{{balanceaccount.totalCredit | currency:'￥'}}</td>
                                    <td class="text-right">{{balanceaccount.totalPaymentAmount | currency:'￥'}}</td>
                                    <td class="text-center">{{balanceaccount.checkStatus | AccountFilter }}</td>
                                    <td class="text-center"><loginuser-employee-empinfo ng-if="balanceaccount.loginUserId !== undefined" id="balanceaccount.loginUserId"></loginuser-employee-empinfo></td><!--计算人-->
                                    <td class="text-center"><loginuser-employee-empinfo ng-if="balanceaccount.checkUserId !== undefined" id="balanceaccount.checkUserId"></loginuser-employee-empinfo></td><!--核对人-->
                                    <td class="text-center">{{balanceaccount.checkDate }}</td>
                                    <td class="text-center"><loginuser-employee-empinfo ng-if="balanceaccount.settleUserId !== undefined" id="balanceaccount.settleUserId"></loginuser-employee-empinfo></td><!--//操作员（结算人付款）-->

                                    <td class="text-center">
                                        <div class="btn-group dropdown" dropdown>
                                            <button class="btn btn-success btn-xs" dropdown-toggle>操作<span class="caret"></span></button>
                                            <ul class="dropdown-menu">
                                                <li><a class="blue" ng-click="view(balanceaccount)" ng-show="true" href>浏览</a></li>
                                                <li><a class="blue" ng-click="count(balanceaccount,$index)" ng-show="true" href>重算</a></li>
                                                <li><a class="blue" ng-click="check(balanceaccount,$index)" ng-show="true" href>核对</a></li>
                                                <li><a class="blue" ng-click="export(balanceaccount,$index)" ng-show="true" ng-modal="export" href>导出</a></li>
                                                <li><a class="blue" ng-click="pay(balanceaccount,$index)" ng-show="true"  href>开始付款</a></li>
                                                <li><a class="blue" ng-click="over(balanceaccount,$index)" ng-show="true" ng-modal="over" href>付款完成</a></li>
                                            </ul>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row b-t b-light m-n lt">
                <div class="col-sm-4 text-left">
                    <ul class="pagination ng-isolate-scope ng-valid">当前页：{{currentPage}}，总计{{totalPages}}页</ul>
                </div>
                <div class="col-sm-8 text-right">
                    <pagination max-size="10" more="true" total-items="totalItems" boundary-links="true" first-text="首页" last-text="尾页"   ng-change="changePage()"  ng-model="currentPage" items-per-page="pageSize" total-items="totalItems"  previous-text="上一页" next-text="下一页"></pagination>
                </div>
            </div>
        </div>
    </div>
</div>
<pageslide ps-open="checked" ps-zindex="1035" ps-size="1500px" ps-body-class="true" ps-auto-close="false" ps-click-outside="false" onopen="onOpenSidePanel" onclose="onCloseSidePanel">

    <div class="hbox hbox-auto-xs bg-light ">
        <div class="col lter b-l">
            <div class="vbox">
                <div class="row-row">
                    <div class="cell">
                        <div class="cell-inner">
                            <div class="wrapper row m-n">
                                <div class="">
                                    <div class="panel-heading">
                                        <span class="h2">{{balanceaccount.year}}-{{balanceaccount.month}}月的订单</span>
                                    </div>

                                    <div class="panel panel-default">
                                        <div class="panel-heading">
                                            <span class="h4">本月结费汇总</span>
                                        </div>
                                        <div class="panel-body">
                                            <div class="col-lg-12">
                                                <div class="row">
                                                    <div class="col-lg-12">
                                                        <div class="form-group pull-in clearfix">
                                                            <div class="col-lg-3">
                                                                <label>借款合计</label>
                                                                <p class="form-control-static b-b">
                                                                    {{balanceaccount.totalCredit | currency:'￥'}}
                                                                </p>
                                                            </div>
                                                            <div class="col-lg-3">
                                                                <label>结算费用合计</label>
                                                                <p class="form-control-static b-b">
                                                                    {{balanceaccount.totalPaymentAmount | currency:'￥'}}
                                                                </p>
                                                            </div>
                                                            <div class="col-lg-3">
                                                                <label>结算状态</label>
                                                                <p class="form-control-static b-b">
                                                                    {{balanceaccount.checkStatus | AccountFilter}}
                                                                </p>
                                                            </div>
                                                            <div class="col-lg-3">
                                                                <label>计算人</label>
                                                                <p class="form-control-static b-b">
                                                                    <loginuser-employee-empinfo ng-if="balanceaccount.loginUserId !== undefined" id="balanceaccount.loginUserId"></loginuser-employee-empinfo>
                                                                </p>
                                                            </div>
                                                        </div>
                                                        <div class="form-group pull-in clearfix">
                                                            <div class="col-lg-3">
                                                                <label>核对日期</label>
                                                                <p class="form-control-static b-b">
                                                                    {{balanceaccount.checkDate  | date:'yyyy-MM-dd'}}
                                                                </p>
                                                            </div>
                                                            <div class="col-lg-3">
                                                                <label>核对人</label>
                                                                <p class="form-control-static b-b">
                                                                    <loginuser-employee-empinfo ng-if="balanceaccount.checkUserId !== undefined" id="balanceaccount.checkUserId"></loginuser-employee-empinfo>
                                                                </p>
                                                            </div>
                                                            <div class="col-lg-3">
                                                                <label>核对信息</label>
                                                                <p class="form-control-static b-b">
                                                                    {{balanceaccount.comment}}
                                                                </p>
                                                            </div>
                                                            <div class="col-lg-3">
                                                                <label>结算人</label>
                                                                <p class="form-control-static b-b">
                                                                    <loginuser-employee-empinfo ng-if="balanceaccount.settleUserId !== undefined" id="balanceaccount.settleUserId"></loginuser-employee-empinfo>
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="panel panel-default" >
                                        <div class="panel-heading">
                                            <span class="h4">结费明细单</span>
                                        </div>
                                        <div class="panel-body">
                                            <div class="row">
                                                <table class="table table-striped b-t b-light m-b-none">
                                                    <thead>
                                                    <th class="text-center">
                                                        客户姓名【身份证号码】
                                                    </th>
                                                    <th class="text-center">
                                                        渠道支行
                                                    </th>
                                                    <!--<th class="text-center">
                                                        刷卡金额
                                                    </th>-->
                                                    <th class="text-center">
                                                        刷卡日期
                                                    </th>
                                                    <th class="text-center">
                                                        业务类型
                                                    </th>
                                                    <th class="text-center">
                                                        手续费缴纳方式
                                                    </th>
                                                    <th class="text-center">
                                                        借款金额
                                                    </th>
                                                    <th class="text-center">
                                                        借款期限
                                                    </th>
                                                    <th class="text-center">
                                                        银行手续费率
                                                    </th>
                                                    <th class="text-center">
                                                        银行手续费金额
                                                    </th>
                                                    <th class="text-center">
                                                        返佣比例
                                                    </th>
                                                    <th class="text-center">
                                                        结算费用金额
                                                    </th>
                                                    <th class="text-center">
                                                        操作
                                                    </th>
                                                    </thead>
                                                    <tbody ng-repeat="balanceaccountdetail in balanceaccountdetails" >
                                                    <tr>
                                                        <td class="text-center"><customer-info id="balanceaccountdetail.customerId"></customer-info></td>
                                                        <td class="text-center"><transaction-cardealer-cooperationcashsource-info ng-if="balanceaccountdetail.transaction !== undefined" transaction="balanceaccountdetail.transaction"></transaction-cardealer-cooperationcashsource-info></td>
                                                        <!--<td class="text-right">{{balanceaccountdetail.swingAmount |  currency:'￥'}}</td>-->
                                                        <td class="text-center">{{balanceaccountdetail.swingCardDate | date:'yyyy-MM-dd'}}</td>
                                                        <td class="text-center">{{balanceaccountdetail.businessTypeCode  | BusinessTypeFilter}}</td>
                                                        <td class="text-center">{{balanceaccountdetail.chargePaymentWay | chargePaymentWayFilter}}</td>
                                                        <td class="text-right">{{balanceaccountdetail.creditAmount |  currency:'￥'}}</td>
                                                        <td class="text-center">{{balanceaccountdetail.creditMonths}}</td>
                                                        <td class="text-center">{{balanceaccountdetail.chargeFeeRatio *100}}%</td>
                                                        <td class="text-right">{{balanceaccountdetail.chargeFee | currency:'￥'}}</td>
                                                        <td class="text-right">{{balanceaccountdetail.chargeCheckRatio *100}}%</td>
                                                        <td class="text-right">{{balanceaccountdetail.checkFee |  currency:'￥'}}</td>
                                                        <td class="text-right"><div class="btn-group dropdown" dropdown>
                                                            <button class="btn btn-success btn-xs" dropdown-toggle>操作<span class="caret"></span></button>
                                                            <ul class="dropdown-menu">
                                                                <li><a class="blue" ng-click="toOrder(balanceaccountdetail)" ng-show="true" href>签约信息</a></li>
                                                                <li><a class="blue" ng-click="toPayment(balanceaccountdetail,$index)" ng-show="true" href>垫资信息</a></li>
                                                                <li><a class="blue" ng-click="toBankCard(balanceaccountdetail,$index)" ng-show="true" href>卡业务信息</a></li>
                                                                <!--<li><a href>业务检查</a></li>-->
                                                                <!--<li class="divider"></li>-->
                                                                <!--<li><a href>卡业务状态</a></li>-->
                                                                <!--<li><a href>还款计划表</a></li>-->
                                                            </ul>
                                                        </div>
                                                        </td>
                                                    </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                                </div>
                    </div>
                    <!--弹出层页面foot-->
                    </div>
                </div>
                <div class="wrapper-sm b-t b-light text-right">
                    <div class="panel-body">
                        <div class="col-sm-6 text-left">
                            <button class="btn btn-success" type="button" ng-if="balanceaccount.checkStatus != 0 && balanceaccount.checkStatus != 1" ng-click="statement(balanceaccount,$index)">银行对账凭证</button>
                        </div>
                        <div class="col-sm-6 text-right">
                            <sign-button ng-if="balanceaccount.id && balanceaccount.transaction" billid="balanceaccount.id" billtypecode="balanceaccount.billTypeCode" buttonshow="110" transaction="balanceaccount.transaction"></sign-button>
                            <button class="btn btn-primary" type="button" ng-click="close()">关 闭</button>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</pageslide>
